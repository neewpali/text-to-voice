<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Text to Voice Tool</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 500px;
      margin: auto;
      padding: 20px;
      text-align: center;
    }
    textarea {
      width: 100%;
      height: 100px;
    }
    select, button {
      margin: 10px;
      padding: 10px;
      width: 100%;
    }
  </style>
</head>
<body>
  <h2>üéôÔ∏è Text to Voice Tool</h2>
  <textarea id="text" placeholder="Enter text here..."></textarea>
  <select id="voices"></select>
  <button onclick="speakText()">üîä Speak</button>
  <button onclick="stopSpeaking()">‚õî Stop</button>
  <button onclick="startRecording()">‚è∫Ô∏è Start Recording</button>
  <button onclick="stopRecording()">‚èπÔ∏è Stop Recording</button>
  <a id="downloadLink" style="display:none;" download="tts_recording.wav">‚¨áÔ∏è Download</a>

  <script>
    const synth = window.speechSynthesis;
    const voiceSelect = document.getElementById('voices');
    let voices = [];

    function loadVoices() {
      voices = synth.getVoices();
      voiceSelect.innerHTML = '';
      voices.forEach((voice, i) => {
        const option = document.createElement('option');
        option.value = i;
        option.textContent = `${voice.name} (${voice.lang})`;
        voiceSelect.appendChild(option);
      });
    }

    loadVoices();
    speechSynthesis.onvoiceschanged = loadVoices;

    function speakText() {
      const text = document.getElementById('text').value;
      const utter = new SpeechSynthesisUtterance(text);
      utter.voice = voices[voiceSelect.value];
      synth.speak(utter);
    }

    function stopSpeaking() {
      synth.cancel();
    }

    // --- Recording the speech ---
    let mediaRecorder;
    let audioChunks = [];

    async function startRecording() {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];

      mediaRecorder.ondataavailable = e => {
        audioChunks.push(e.data);
      };

      mediaRecorder.onstop = () => {
        const blob = new Blob(audioChunks, { type: 'audio/wav' });
        const url = URL.createObjectURL(blob);
        const downloadLink = document.getElementById('downloadLink');
        downloadLink.href = url;
        downloadLink.style.display = 'block';
      };

      mediaRecorder.start();
      alert("Recording started...");
    }

    function stopRecording() {
      if (mediaRecorder && mediaRecorder.state !== 'inactive') {
        mediaRecorder.stop();
        alert("Recording stopped.");
      }
    }
  </script>
</body>
</html>
